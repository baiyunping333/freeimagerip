INCLUDE_DIRECTORIES(${PROJECT_DIR})

IF(SUSIE_PLUGIN)
	SET(CMAKE_LINK_DEF_FILE_FLAG "/DEF:${PLUGIN_DIR}/Susie/spi.def")
	ADD_LIBRARY(susie SHARED ${PLUGIN_DIR}/Susie/susie.cc ${PLUGIN_DIR}/Susie/spi.def)
	ADD_DEPENDENCIES(susie freeimage)
	TARGET_LINK_LIBRARIES(susie freeimage)
	SET_TARGET_PROPERTIES(susie PROPERTIES OUTPUT_NAME "iffi" SUFFIX ".spi")
ENDIF()

IF(QT_PLUGIN)
	FIND_PACKAGE(Qt4 REQUIRED)
	INCLUDE(${QT_USE_FILE})
	ADD_LIBRARY(qfi4 SHARED ${PLUGIN_DIR}/Qt/main.cc ${PLUGIN_DIR}/Qt/fihandler.cc)
	ADD_DEPENDENCIES(qfi4 freeimage)
	TARGET_LINK_LIBRARIES(qfi4 freeimage ${QT_LIBRARIES})
ENDIF()

IF(CONV_TEST)
	ADD_EXECUTABLE(convtest ${PROJECT_DIR}/Test/conv.cc)
	ADD_DEPENDENCIES(convtest freeimage)
	TARGET_LINK_LIBRARIES(convtest freeimage)
ENDIF()
